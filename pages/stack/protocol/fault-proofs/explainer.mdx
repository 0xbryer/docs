---
title: Fault Proofs Explainer
lang: en-US
description: Learn about the OP Stack's fault proof system.
---

import { Callout } from 'nextra/components'
import Image from 'next/image'

# Fault Proofs Explainer

Fault Proofs reduce the trust assumptions for users by enabling permissionless output proposals and a permissionless fault proof system. The initial rollout preserves the guardian's permissioned role to override this system in case of an emergency. 
The fault proofs upgrade moves closer to technical decentralization by:

*   allowing anyone to post the L2 state root, along with a financial bond
*   allowing anyone to challenge posted L2 state roots through a `FaultDisputeGame`
*   enabling users to send messages from L2 to L1 without the need to involve any trusted third party
*   enhancing the security of bridged ETH and ERC-20 tokens with an improved trust model
*   allowing anyone to challenge invalid proposals through participating in an associated dispute game
*   building a modular design of the fault proof system, allowing for easy integration of additional proving mechanisms.

## Permissionless Fault Proofs

Pernissionless Fault Proofs serve as a security mechanism for OP Stack Chains, enabling validators to propose or dispute claims about an OP Stack Chain's state on Ethereum.
These claims about an OP Stack Chain's state allow anyone to verify and ensure the validity and security of transactions and withdrawals on the OP Stack Chain. 

See the permission fault proofs diagram below for more details:
<br />
<Image src="/img/op-stack/protocol/fp-permissionless.png" alt="Permissionless Fault Proofs flow" width={700} height={600} />

In [Optimistic Rollups (OP Stack Chains)](/stack/protocol/rollup/overview), there is a \~1 week challenge period where anyone can challenge the output root if they see that the root is not an accurate representation of the rollup's state.
With permissionless fault proofs, anyone can spin up their own node and challenger service that can either propose a state (output root) or dispute a state root (output proposal) submitted by a proposer. Specifically, the additional challenger service (`op-challenger`) can be attached to the node to participate in the dispute games.

The node can:

*   Post claims about an OP Stack chain's state to Ethereum (i.e, propose output roots)
*   Challenge invalid claims (output roots) made by other validators

## Modular Design and Multi-layer Security

Fault Proof for OP Stack Chains is [modular in design](/stack/protocol/fault-proofs/fp-components#system-design--modularity) and lays the groundwork for achieving a multiproof system. This allows the OP Stack to support multiple proof systems in a future state along with [Cannon](/stack/protocol/fault-proofs/cannon) (the default fault proof virtual machine), which is crucial for achieving greater decentralization and scalable security.

Additionally, the following [security safeguards](/stack/protocol/fault-proofs/fp-security) have been built around the game, as follows:

*   An off chain monitoring system has been set up to monitor all proposed roots and ensure they align with the correct state. See [`op-dispute-mon`](https://github.com/ethereum-optimism/optimism/blob/develop/op-dispute-mon/README.md?plain=1) for more details.
*   After a root is finalized through a game, an additional delay has been added before withdrawals can occur. During this period, the `GUARDIAN` role can reject the root. This will allow the monitoring to stop invalid withdrawals.
*   A contract called `DelayedWETH` has been set up to hold the bonds and only allow payouts after a delay, so that bonds can be redirected towards the rightful recipient in the event that a game is abused.
*   If there is a disagreement over the result of the fault proofs, the security council can intervene and reject the outcome of the dispute game.

## Considerations

OP Stack developers must keep the following considerations in mind for fault proofs:

*   As a part of the `OptimismPortal` being upgraded (the contract that handles withdrawals), all previously proved withdrawals will no longer work. This means that any previously proven withdrawal that has not yet been finalized will need to be reproved, including an additional wait before being able to finalize.
*   There may be cases where the proposer becomes malicious and chooses to either not submit a state root (to censor transactions) or submit a false/malicious state root (to steal funds from the OP Stack Chain).
    This could result in funds being stolen from the OP Stack Chain or transactions being censored. However, with permissionless fault proofs, anyone can spin up their own validator node and challenge the state root (output root) or post their own state root (output proposal).

## Next Steps

*   Ready to get started? Review the [FP Components](fp-components) to learn how the different components work together to enhance decentralization in the Optimism ecosystem.
*   See the [Fault Proof Mainnet Security](/stack/protocol/fault-proofs/fp-security) to understand changes to `OptimismPortal` and `DisputeGame` contracts.
*   For more info about how the the FP system works under the hood, [check out the specs](https://specs.optimism.io/fault-proof/index.html).

## FAQs

### How many steps/transactions are required to settle a dispute (worst-case scenario)?

The maximum depth of a game is 73, but there can be any number of claims and counter-claims within a dispute game.
Due to the permissionless structure where many different actors can participate in the same game, a single claim may be countered by any number of different counter-claims, effectively combining multiple disputes into a single game.

### Are there any dependencies to consider when proposing a new state root (in the event of sequencer and proposer failure)?

Users are able to complete the full withdrawal cycle without depending on any privileged action.
The caveat is that the Guardian role has the ability to override the system by either blacklisting games or reverting to a permissioned system.
So the trust assumption is reduced to requiring only that the guardian role does not act to intervene but there is still a trust assumption, inline with the stage 1 requirements.

### Since the roles of proposer and challenger will be open to everyone, are guides available outlining the best practices for running them?

It's not expected that normal users run `op-proposer` to regularly propose output roots.
Users would generally just propose a single output root if they need to withdraw and the chain operator isn't proposing outputs for them via direct calls to the `DisputeGameFactory` via Etherscan or using the [`create-game`](https://github.com/ethereum-optimism/optimism/tree/develop/op-challenger#create-game) subcommand of op-challenger.
OP-challenger docs are forthcoming.

### How much ether should a chain operator put aside to operate the fault proof system?
As much you can spare. The nominal operating cost of running FPs (i.e., assuming no invalid proposals or malicious actors) will depend on the initial bond set for the Dispute Game and the frequency of posting proposals. 
Assuming op-mainnet parameters, where we'll be posting proposals hourly, that's 0.08 ETH per hour. Assuming a 7 day dispute window, you'll need roughly 14 ETH (including gas costs) to make proposals.
If chains are using the similar FP deploy configs as op-mainnet, I recommend they stick to a 0.08 ETH initial bond.

However, the capital requirements for operating a FP chain in itself is much larger than 14 ETH. An operator that secures their chain using FPs must be willing to stake a lot of ETH to secure the chain. 
Since all it takes is one bad dispute game to loot the entire bridge. One may decide the capital requirements aren't worth it, and use only a Permissioned FP system.
The capital requirements will be improved in the later stages of Fault Proofs to make it more feasible for smaller chains. But right now, unless you're able to marshal several thousand ETH in funds to defend a permissionless FP chain, it's probably best to use permissioned FPs.

One middle ground is to put a hard cap on operating costs. Say 100 ETH. And then switch to permissioned FPs only when those costs are overrun (cuz the chain is under attack). 
If you do this, then you'll have to contend with the possible reputational and switching costs of reverting to a permissioned FP system though. 
For example, withdrawals against permissioned FPs will be invalidated and would have to be re-created for the permissioned FPs. 100 ETH isn't really a lot for a well-funded attacker to try something - if not to frustrate chain operations.

### How large are the bonds expected to be needed to sustain and win a dispute?

The bonds are sized based on the anticipated cost to post a counter claim as well as to deter spamming invalid claims.
As an example, on OP Sepolia, the game [`0xcf8f181497DAD07277781517A76cb131C54A1BEE`](https://sepolia.etherscan.io/address/0xcf8f181497DAD07277781517A76cb131C54A1BEE) shows the escalating bond sizes. The list-claims subcommand of op-challenger can also provide a good view of the claims in the game:

```
./op-challenger/bin/op-challenger list-claims --l1-eth-rpc <SEPOLIA_L1> --game-address 0xcf8f181497DAD07277781517A76cb131C54A1BEE
```

See the [specs](https://specs.optimism.io/experimental/fault-proof/stage-one/bond-incentives.html) for more details.
