---
title: Creating Your Own L2 Rollup Testnet
lang: en-US
description: This tutorial walks you through spinning up an OP Stack testnet chain.
---

import { Callout, Steps } from 'nextra/components'

# Creating Your Own L2 Rollup Testnet

<Callout type="info">
Please **be prepared to set aside approximately one hour** to get everything running properly and **make sure to read through the guide carefully**.
You don't want to miss any important steps that might cause issues down the line.
</Callout>

This tutorial is **designed for developers** who want to learn about the OP Stack by spinning up an OP Stack testnet chain.
You'll walk through the full deployment process and teach you all of the components that make up the OP Stack, and **you'll end up with your very own OP Stack testnet**.

You can use this testnet to experiment and perform tests, or you can choose to modify the chain to adapt it to your own needs.
**The OP Stack is free and open source software licensed entirely under the MIT license**.
You don't need permission from anyone to modify or deploy the stack in any configuration you want.

<Callout type="warning">
Modifications to the OP Stack may prevent a chain from being able to benefit from aspects of the [Optimism Superchain](/stack/explainer).
Make sure to check out the [Superchain Explainer](/stack/explainer) to learn more.
</Callout>

## What You're Going to Deploy

When deploying an OP Stack chain, you'll be setting up four different components.
It's useful to understand what each of these components does before you start deploying your chain.

### Smart Contracts

The OP Stack gives you the ability to deploy your own Rollup chains that use a Layer 1 blockchain to host and order transaction data.
OP Stack chains use several smart contracts on the L1 blockchain to manage aspects of the Rollup.
Each OP Stack chain has its own set of L1 smart contracts that are deployed when the chain is created.
You'll be using the L1 Bedrock smart contracts found in the [`contracts-bedrock` package](https://github.com/ethereum-optimism/optimism/tree/op-contracts/v1.0.0/packages/contracts-bedrock) within the [Optimism Monorepo](https://github.com/ethereum-optimism/optimism).

<Callout type="info">
  You should only use governance approved and audited smart contracts. 
  The monorepo has them tagged with the following pattern `op-contracts/vX.X.X` 
  and you can review the release notes for details on the changes. Read more 
  about the details on our [Smart Contract Overview](/stack/protocol/smart-contracts).
</Callout>

### Sequencer Node

OP Stack chains use Sequencer nodes to gather proposed transactions from users and publish them to the L1 blockchain.
Vanilla (unmodified) OP Stack chains rely on at least one of these Sequencer nodes, so you'll have to run one.
You can also run additional non-Sequencer nodes if you'd like (not included in this tutorial).

#### Consensus Client

OP Stack nodes, like Ethereum nodes, have a consensus client.
The consensus client is responsible for determining the list and ordering of blocks and transactions that are part of your blockchain.
Several implementations of the OP Stack consensus client exist, including `op-node` (maintained by Optimism Foundation), [`magi`](https://github.com/a16z/magi) (maintained by a16z) and [`hildr`](https://github.com/optimism-java/hildr) (maintained by OptimismJ).
In this tutorial you'll be using the [`op-node` implementation](https://github.com/ethereum-optimism/optimism/tree/v1.1.4/op-node) found within the [Optimism Monorepo](https://github.com/ethereum-optimism/optimism).

#### Execution Client

OP Stack nodes, like Ethereum nodes, also have an execution client.
The execution client is responsible for executing transactions and storing/updating the state of the blockchain.
Various implementations of the OP Stack execution client exist, including `op-geth` (maintained by Optimism Foundation), [`op-erigon`](https://github.com/testinprod-io/op-erigon) (maintained by Test in Prod), and `op-nethermind` (coming soon).
In this tutorial you'll be using the [`op-geth` implementation](https://github.com/ethereum-optimism/op-geth) found within the [`op-geth` repository](https://github.com/ethereum-optimism/op-geth).

### Batcher

The Batcher is a service that publishes transactions from the Sequencer to the L1 blockchain.
The Batcher runs continuously alongside the Sequencer and publishes transactions in batches (hence the name) on a regular basis.
You'll be using the [`op-batcher` implementation](https://github.com/ethereum-optimism/optimism/tree/v1.1.4/op-batcher) of the Batcher component found within the [Optimism Monorepo](https://github.com/ethereum-optimism/optimism).

### Proposer

The Proposer is a service responsible for publishing transactions *results* (in the form of L2 state roots) to the L1 blockchain.
This allows smart contracts on L1 to read the state of the L2, which is necessary for cross-chain communication and reconciliation between state changes.
It's likely that the Proposer will be removed in the future, but for now it's a necessary component of the OP Stack.
You'll be using the [`op-proposer` implementation](https://github.com/ethereum-optimism/optimism/tree/v1.1.4/op-proposer) of the Proposer component found within the [Optimism Monorepo](https://github.com/ethereum-optimism/optimism).

## Software Dependencies

| Dependency                                                    | Version  | Version Check Command |
| ------------------------------------------------------------- | -------- | --------------------- |
| [git](https://git-scm.com/)                                   | `^2`     | `git --version`       |
| [go](https://go.dev/)                                         | `^1.21`  | `go version`          |
| [node](https://nodejs.org/en/)                                | `^20`    | `node --version`      |
| [pnpm](https://pnpm.io/installation)                          | `^8`     | `pnpm --version`      |
| [foundry](https://github.com/foundry-rs/foundry#installation) | `^0.2.0` | `forge --version`     |
| [make](https://linux.die.net/man/1/make)                      | `^3`     | `make --version`      |
| [jq](https://github.com/jqlang/jq)                            | `^1.6`   | `jq --version`        |
| [direnv](https://direnv.net)                                  | `^2`     | `direnv --version`    |

### Notes on Specific Dependencies

#### `node`

We recommend using the latest LTS version of Node.js (currently v20).
[`nvm`](https://github.com/nvm-sh/nvm) is a useful tool that can help you manage multiple versions of Node.js on your machine.
You may experience unexpected errors on older versions of Node.js.

#### `foundry`

It's recommended to use the scripts in the monorepo's `package.json` for managing `foundry` to ensure you're always working with the correct version. This approach simplifies the installation, update, and version checking process. Make sure to clone the monorepo locally before proceeding.
#### `direnv`

Parts of this tutorial use [`direnv`](https://direnv.net) as a way of loading environment variables from `.envrc` files into your shell.
This means you won't have to manually export environment variables every time you want to use them.
`direnv` only ever has access to files that you explicitly allow it to see.

After [installing `direnv`](https://direnv.net/docs/installation.html), you will need to **make sure that [`direnv` is hooked into your shell](https://direnv.net/docs/hook.html)**.
Make sure you've followed [the guide on the `direnv` website](https://direnv.net/docs/hook.html), then **close your terminal and reopen it** so that the changes take effect (or `source` your config file if you know how to do that).

<Callout>
Make sure that you have correctly hooked `direnv` into your shell by modifying your shell configuration file (like `~/.bashrc` or `~/.zshrc`).
If you haven't edited a config file then you probably haven't configured `direnv` properly (and things might not work later).
</Callout>

## Get Access to a Sepolia Node

You'll be deploying a OP Stack Rollup chain that uses a Layer 1 blockchain to host and order transaction data.
The OP Stack Rollups were designed to use EVM Equivalent blockchains like Ethereum, OP Mainnet, or standard Ethereum testnets as their L1 chains.

**This guide uses the Sepolia testnet as an L1 chain**.
We recommend that you also use Sepolia.
You can also use other EVM-compatible blockchains, but you may run into unexpected errors.
If you want to use an alternative network, make sure to carefully review each command and replace any Sepolia-specific values with the values for your network.

Since you're deploying your OP Stack chain to Sepolia, you'll need to have access to a Sepolia node.
You can either use a node provider like [Alchemy](https://www.alchemy.com/) (easier) or run your own Sepolia node (harder).

## Layer 1

You're going to be spinning up your OP Stack chain directly from source code instead of using a container system like [Docker](https://www.docker.com/).
Although this adds a few extra steps, it means you'll have an easier time modifying the behavior of the stack if you'd like to do so.
If you want a summary of the various components you'll be using, take another look at the [What You're Going to Deploy](#what-youre-going-to-deploy) section above.


### Build the Optimism Monorepo

<Steps>

{<h3>Clone the Optimism Monorepo</h3>}

```bash
cd ~
git clone https://github.com/ethereum-optimism/optimism.git
```

{<h3>Enter the Optimism Monorepo</h3>}

```bash
cd optimism
```

{<h3>Check out the correct branch</h3>}

<Callout>
You will be using the `tutorials/chain` branch of the Optimism Monorepo to deploy an OP Stack testnet chain during this tutorial.
This is a non-production branch that lags behind the `develop` branch.
You should **NEVER** use the `develop` or `tutorials/chain` branches in production.
</Callout>

```bash
git checkout tutorials/chain
```

{<h3>Check your dependencies</h3>}

<Callout>
Don't skip this step! Make sure you have all of the required dependencies installed before continuing.
</Callout>

Run the following script and double check that you have all of the required versions installed.
If you don't have the correct versions installed, you may run into unexpected errors.

```bash
./packages/contracts-bedrock/scripts/getting-started/versions.sh
```

{<h3>Install monorepo dependencies</h3>}

```bash
pnpm install
```
</Steps>



## Layer 2

todo: push to L2 section
{<h3>Build the various packages inside of the Optimism Monorepo</h3>}

```bash
make op-node op-batcher op-proposer
pnpm build
```

### Build `op-geth`

<Steps>

{<h3>Clone op-geth</h3>}

```bash
cd ~
git clone https://github.com/ethereum-optimism/op-geth.git
```

{<h3>Enter op-geth</h3>}

```bash
cd op-geth
```

{<h3>Build op-geth</h3>}

```bash
make geth
```

</Steps>