---
title: OP Stack Smart Contract Deployment
lang: en-US
description: Learn how to deploy the OP Stack L1 smart contracts.
---

import { Callout } from 'nextra/components'

# OP Stack Smart Contract Deployment

The following guide shows you how to deploy the OP Stack L1 smart contracts.
The primary development branch is `develop`. It contains the most up-to-date
software that remains backwards compatible with the latest experimental
network deployments. **Changes made to the smart contracts are usually
NOT considered backwards compatible.**

<Callout>
  Standard OP Stack chains should use governance approved and audited versions
  of the smart contract code.
</Callout>

## Deployment Configuration

Deploying your OP Stack contracts require creating a deployment configuration
JSON file. For the full set of options, you can see the [rollup configuration page](/builders/chain-operators/configuration/rollup).

todo: add config examples

### Standard Rollup Configuration Example

The following is an example deployment configuration file for a Standard OP
Stack chain.

```json
todo
```

### Custom Gas Token Configuration Example

The following is an example deployment configuration file for a Custom Gas
Token OP Stack chain.

```json
{
    "l1StartingBlockTag": "0x4aa844899a9a2da60e79b54029845f9d6e58d7e76ced5bba582a5e0a594bfeec",
    "l1ChainID": 11155111,
    "l2ChainID": 35605,
    "l2BlockTime": 2,
    "l1BlockTime": 12,
    "finalizationPeriodSeconds": 604800,
    "systemConfigOwner": "0x23BA22Dd7923F3a3f2495bB32a6f3c9b9CD1EC6C",
    "finalSystemOwner": "0x23BA22Dd7923F3a3f2495bB32a6f3c9b9CD1EC6C",
    "controller": "0x45eFFbD799Ab49122eeEAB75B78D9C56A187F9A7",
    "baseFeeVaultRecipient": "0x45eFFbD799Ab49122eeEAB75B78D9C56A187F9A7",
    "l1FeeVaultRecipient": "0x45eFFbD799Ab49122eeEAB75B78D9C56A187F9A7",
    "sequencerFeeVaultRecipient": "0x45eFFbD799Ab49122eeEAB75B78D9C56A187F9A7",
    "l2GenesisBlockBaseFeePerGas": "0x3b9aca00",
    "governanceTokenOwner": "0x23BA22Dd7923F3a3f2495bB32a6f3c9b9CD1EC6C",
    "governanceTokenSymbol": "OP",
    "governanceTokenName": "Optimism",
    "maxSequencerDrift": 600,
    "sequencerWindowSize": 3600,
    "channelTimeout": 300,
    "p2pSequencerAddress": "0xb1b9C3d2c6E459668A46c8f3F89aE59bE57576af",
    "optimismL2FeeRecipient": "0xA3c7F4d2EbEC2F99F07f29fa46c2744aec24aC31",
    "batchInboxAddress": "0x21b49D3897be216c52Fb19A7AD5a9d4B9b1cD539",
    "batchSenderAddress": "0x2cb19acF5445d33061dB1c07B0224080c103039f",
    "l2GenesisRegolithTimeOffset": "0x0",
    "portalGuardian": "0x45eFFbD799Ab49122eeEAB75B78D9C56A187F9A7",
    "l2OutputOracleSubmissionInterval": 10800,
    "l2OutputOracleStartingTimestamp": -1,
    "l2OutputOracleStartingBlockNumber": 0,
    "l2OutputOracleProposer": "0x74d3F780a70438e81bFCfDf69732Da00F57fc960",
    "l2OutputOracleOwner": "0x4e588f9f1Bfd9B4d8B3868a1a4747f0CCaAD45A6",
    "sequencerFeeVaultWithdrawalNetwork": 0,
    "baseFeeVaultWithdrawalNetwork": 0,
    "l1FeeVaultWithdrawalNetwork": 0,
    "baseFeeVaultMinimumWithdrawalAmount": "0x8ac7230489e80000",
    "l1FeeVaultMinimumWithdrawalAmount": "0x8ac7230489e80000",
    "sequencerFeeVaultMinimumWithdrawalAmount": "0x8ac7230489e80000",
    "l2GenesisBlockGasLimit": "0x1c9c380",
    "fundDevAccounts": false,
    "gasPriceOracleOverhead": 188,
    "gasPriceOracleScalar": 68400,
    "eip1559Denominator": 50,
    "eip1559Elasticity": 6,
    "superchainConfigGuardian": "0xA9FF930151130fd19DA1F03E5077AFB7C78F8503",
    "l2GenesisCanyonTimeOffset": "0x0",
    "l2GenesisDeltaTimeOffset": "0x0",
    "l2GenesisEcotoneTimeOffset": "0x0",
    "eip1559DenominatorCanyon": 250,
    "useCustomGasToken": false,
    "customGasTokenAddress": "0x0000000000000000000000000000000000000000",
    "useFaultProofs": false,
    "systemConfigStartBlock": 0,
    "enableGovernance": false,
    "requiredProtocolVersion": "0x0000000000000000000000000000000000000000000000000000000000000000",
    "recommendedProtocolVersion": "0x0000000000000000000000000000000000000000000000000000000000000000",
    "faultGameAbsolutePrestate": "0x03c7ae758795765c6664a5d39bf63841c71ff191e9189522bad8ebff5d4eca98",
    "faultGameGenesisOutputRoot": "0x0000000000000000000000000000000000000000000000000000000000000000",
    "faultGameMaxDepth": 73,
    "faultGameClockExtension": 10800,
    "faultGameMaxClockDuration": 302400,
    "faultGameGenesisBlock": 0,
    "faultGameSplitDepth": 30,
    "faultGameWithdrawalDelay": 604800,
    "preimageOracleMinProposalSize": 126000,
    "preimageOracleChallengePeriod": 86400,
    "proofMaturityDelaySeconds": 604800,
    "disputeGameFinalityDelaySeconds": 302400,
    "respectedGameType": 0,
    "usePlasma": true,
    "daChallengeWindow": 1800,
    "daResolveWindow": 1800,
    "daBondSize": 103486250000000000,
    "daResolverRefundPercentage": 100,
    "proxyAdmin": "0x799c00551eEC969Bc8c8D7e3db5E4aeBbB9b7876",
    "proxyAdminOwner": "0x45eFFbD799Ab49122eeEAB75B78D9C56A187F9A7",
    "optimismBaseFeeRecipient": "0xAeF661cF30689f6707E124707EB8F0CaDFdB55c2",
    "optimismL1FeeRecipient": "0xFB72e288d9a3B543503d8D02AbF9a22C8e7f32b8",
    "l2CrossDomainMessengerOwner": "0x3ED1807d4921e9977E6BE7615BD1AACab20C8516",
    "gasPriceOracleOwner": "0xd17816E3048bf5BD95BDab41B4C1C8D29C6Eb40E",
    "l2OutputOracleChallenger": "0x45eFFbD799Ab49122eeEAB75B78D9C56A187F9A7"
  }
```

### Alt-DA Mode (Plasma Mode) Configuration Example

The following is an example deployment configuration file for an OP Stack
chain running in Alt-DA mode.

```json
todo
```

## Deployment Script

The smart contracts are deployed using [foundry](https://github.com/foundry-rs).

### State Diff

Before deploying the contracts, you can verify the state diff produced by the deployment script using the
deploy script using the `runWithStateDiff()` function signature which produces
the outputs inside [`snapshots/state-diff/`](https://github.com/ethereum-optimism/optimism/tree/develop/packages/contracts-bedrock/snapshots/state-diff).
Run the deployment with state diffs by executing:

```bash
forge script -vvv scripts/Deploy.s.sol:Deploy --sig 'runWithStateDiff()' --rpc-url $ETH_RPC_URL --broadcast --private-key $PRIVATE_KEY
```

### Execution

*   Set the `ETHERSCAN_API_KEY` and add the `--verify` flag to verify your
    contracts.
*   `DEPLOYMENT_OUTFILE` will determine the filepath that the deployment
    artifact is written to on disk after the deployment. It comes in the form of a
    JSON file where keys are the names of the contracts and the values are the
    addresses the contract was deployed to.
*   `DEPLOY_CONFIG_PATH` is the path on the filesystem that points to a deployment
    config. The same deploy config JSON file should be used for L1 contracts
    deployment as when generating the L2 genesis allocs. See the [deploy-config](https://github.com/ethereum-optimism/optimism/tree/develop/packages/contracts-bedrock/deploy-config)
    directory for examples and the [rollup configuration page](/builders/chain-operators/configuration/rollup)
    for descriptions of the values.
*   `IMPL_SALT` env var can be used to set the create2 salt for deploying the
    implementation contracts.

This will deploy an entire new system of L1 smart contracts, including a new
SuperchainConfig. In the future there will be an easy way to deploy only
proxies and use shared implementations for each of the contracts as well as a
shared SuperchainConfig contract.

```
DEPLOYMENT_OUTFILE=deployments/artifact.json \
DEPLOY_CONFIG_PATH=<PATH_TO_MY_DEPLOY_CONFIG> \
  forge script scripts/Deploy.s.sol:Deploy \
  --broadcast --private-key $PRIVATE_KEY \
  --rpc-url $ETH_RPC_URL
```

### Deploying a single contract

All of the functions for deploying a single contract are public meaning that
the `--sig` argument to forge script can be used to target the deployment of a
single contract.

## Best Practices

Production users should deploy their L1 contracts from a contracts release.
All contracts releases are on git tags with the following format:
`op-contracts/vX.Y.Z`. If you're deploying a new standard chain, you should
deploy the [Multi-Chain Prep (MCP) L1 release](https://github.com/ethereum-optimism/optimism/releases/tag/op-contracts%2Fv1.3.0).
We're working on writing more documentation to prepare OP Stack chain operators
to run a fault proof chain effectively.

## Next Steps

*   Learn how to [create your genesis file](/builders/chain-operators/deploy/genesis)
